<html>
	<head>
		<title> Welcome to GeEmail </title>
		<script src="js/mail-generator.js"></script>
		<link href="css/style.css" rel="stylesheet" media="screen">
    <script>
      window.onload = function(){
        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser
		var user = prompt("User login required", "Username");
        title.innerHTML = "Welcome to " + user + "'s GeEmail!"
        var table = document.getElementById("tableBody");

        function inbox(geemail) {
        	var geemailContent = document.getElementById("tableBody");

        	var row = document.createElement("tr");
        	row.className = ("row")
        	geemailContent.appendChild(row);
        	row.addEventListener("click", function(event) {
        		showMessageInWindow(geemail);
        	})

        	var sender = document.createElement("td");
        	sender.className = ("sender");
        	sender.innerHTML = geemail.sender.bold();
        	row.appendChild(sender);

        	var subject = document.createElement("td");
        	subject.className = ("subject");
        	subject.innerHTML = geemail.subject.bold() + ": ".bold() + geemail.body.substring(0, 50) + "...";
        	row.appendChild(subject);

        	var date = document.createElement("td");
        	date.className = ("date");
        	date.innerHTML = geemail.date;
        	row.appendChild(date);


        }
        
        var geemailsNum = geemails.length

        function showMessageInWindow(selected) {
        	var emailWindow = window.open("", "_blank", "width = 600, height = 600");
        	emailWindow.document.write("<p> Sender: " + selected.sender + "<br/>" + "Subject: " +//
        		selected.subject + "<br/>" + "Date: " + selected.date//
        		+ "<br/>" + "<br/>" + "<br/>"+ selected.body + "</p>");
        }


        function newMail(){
        	var newGeemail = getNewMessage();
        	inbox(newGeemail);
     	    geemailsNum++;
     	    inboxNumber.innerHTML = geemailsNum;
        }
        
        setInterval(newMail, 7000);

        inboxNumber.innerHTML = geemailsNum;
        
        for(var i = 0; i < window.geemails.length; i++) {
        	inbox(window.geemails[i]);
        };



    	
    	};

    </script>
	</head>
	<body>

		<div class="container">
			<div id="title">
		</div>
		<div class="container" id="inboxRow">
			<div id="inbox">
				<div id="inboxText">New Mail:</div>
				<div id = "inboxNumber"> </div>
			</div>
		</div>
		<div id="emailContainer">
			<table>
				<thead>
					<tr>
						<th id="from">FROM
						</th>
						<th id="subject">SUBJECT
						</th>
						<th id="date">RECIEVED ON
						</th>
					</tr>
				</thead>
				<tbody id="tableBody">
				</tbody>
			</table>
		</div>
	</body>
</html>